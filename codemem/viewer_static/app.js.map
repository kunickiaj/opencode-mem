{"version":3,"file":"app.js","sources":["../../viewer_ui/src/app.ts"],"sourcesContent":["/* Viewer UI source (TypeScript).\n *\n * Built to: opencode_mem/viewer_static/app.js (served at /assets/app.js)\n */\n\n/* global marked, lucide */\n\nconst refreshStatus = document.getElementById('refreshStatus');\nconst statsGrid = document.getElementById('statsGrid');\nconst metaLine = document.getElementById('metaLine');\nconst feedList = document.getElementById('feedList');\nconst feedMeta = document.getElementById('feedMeta');\nconst feedTypeToggle = document.getElementById('feedTypeToggle');\nconst feedSearch = document.getElementById('feedSearch') as HTMLInputElement | null;\nconst sessionGrid = document.getElementById('sessionGrid');\nconst sessionMeta = document.getElementById('sessionMeta');\nconst settingsButton = document.getElementById('settingsButton');\nconst settingsBackdrop = document.getElementById('settingsBackdrop');\nconst settingsModal = document.getElementById('settingsModal');\nconst settingsClose = document.getElementById('settingsClose');\nconst settingsSave = document.getElementById('settingsSave');\nconst settingsStatus = document.getElementById('settingsStatus');\nconst settingsPath = document.getElementById('settingsPath');\nconst settingsEffective = document.getElementById('settingsEffective');\nconst settingsOverrides = document.getElementById('settingsOverrides');\nconst observerProviderInput = document.getElementById(\n  'observerProvider',\n) as HTMLSelectElement | null;\nconst observerModelInput = document.getElementById(\n  'observerModel',\n) as HTMLInputElement | null;\nconst observerMaxCharsInput = document.getElementById(\n  'observerMaxChars',\n) as HTMLInputElement | null;\nconst observerMaxCharsHint = document.getElementById('observerMaxCharsHint');\nconst packObservationLimitInput = document.getElementById(\n  'packObservationLimit',\n) as HTMLInputElement | null;\nconst packSessionLimitInput = document.getElementById(\n  'packSessionLimit',\n) as HTMLInputElement | null;\nconst syncEnabledInput = document.getElementById(\n  'syncEnabled',\n) as HTMLInputElement | null;\nconst syncHostInput = document.getElementById(\n  'syncHost',\n) as HTMLInputElement | null;\nconst syncPortInput = document.getElementById(\n  'syncPort',\n) as HTMLInputElement | null;\nconst syncIntervalInput = document.getElementById(\n  'syncInterval',\n) as HTMLInputElement | null;\nconst syncMdnsInput = document.getElementById(\n  'syncMdns',\n) as HTMLInputElement | null;\nconst projectFilter = document.getElementById(\n  'projectFilter',\n) as HTMLSelectElement | null;\nconst themeToggle = document.getElementById(\n  'themeToggle',\n) as HTMLButtonElement | null;\nconst syncMeta = document.getElementById('syncMeta');\nconst syncHealthGrid = document.getElementById('syncHealthGrid');\nconst syncStatusGrid = document.getElementById('syncStatusGrid');\nconst syncDiagnostics = document.getElementById('syncDiagnostics');\nconst syncPeers = document.getElementById('syncPeers');\nconst syncAttempts = document.getElementById('syncAttempts');\nconst syncNowButton = document.getElementById(\n  'syncNowButton',\n) as HTMLButtonElement | null;\nconst syncDetailsToggle = document.getElementById(\n  'syncDetailsToggle',\n) as HTMLButtonElement | null;\nconst syncPairingToggle = document.getElementById(\n  'syncPairingToggle',\n) as HTMLButtonElement | null;\nconst syncRedact = document.getElementById(\n  'syncRedact',\n) as HTMLInputElement | null;\nconst pairingPayload = document.getElementById('pairingPayload');\nconst pairingCopy = document.getElementById(\n  'pairingCopy',\n) as HTMLButtonElement | null;\nconst pairingHint = document.getElementById('pairingHint');\nconst syncPairing = document.getElementById('syncPairing');\n\nlet configDefaults: Record<string, any> = {};\nlet configPath = '';\nlet currentProject = '';\nconst itemViewState = new Map();\nconst itemExpandState = new Map<string, boolean>();\nconst FEED_FILTER_KEY = 'opencode-mem-feed-filter';\nconst FEED_FILTERS = ['all', 'observations', 'summaries'];\n\nconst SYNC_DIAGNOSTICS_KEY = 'opencode-mem-sync-diagnostics';\nconst SYNC_PAIRING_KEY = 'opencode-mem-sync-pairing';\nconst SYNC_REDACT_KEY = 'opencode-mem-sync-redact';\nlet feedTypeFilter = 'all';\nlet pairingPayloadRaw: any = null;\nlet pairingCommandRaw = '';\nlet lastSyncStatus: any = null;\nlet lastSyncPeers: any[] = [];\nlet lastSyncAttempts: any[] = [];\nlet syncPairingOpen = false;\n\nlet refreshInFlight = false;\nlet refreshQueued = false;\nlet refreshTimer: ReturnType<typeof setInterval> | null = null;\nlet lastFeedSignature = '';\nlet lastFeedItems: any[] = [];\nlet lastFeedFilteredCount = 0;\nlet feedQuery = '';\n\n// Previously used for a manual \"apply new items\" banner.\n// Kept null to preserve compatibility with older builds, but unused now.\nlet pendingFeedItems: any[] | null = null;\nlet refreshState: 'idle' | 'refreshing' | 'paused' | 'error' = 'idle';\n\nconst newItemKeys = new Set<string>();\n\nlet settingsDirty = false;\n\nfunction setSettingsDirty(next: boolean) {\n  settingsDirty = next;\n  if (settingsSave) {\n    (settingsSave as any).disabled = !next;\n  }\n}\n\nfunction isSettingsOpen() {\n  return Boolean(settingsModal && !settingsModal.hasAttribute('hidden'));\n}\n\nfunction setRefreshStatus(state: typeof refreshState, detail?: string) {\n  refreshState = state;\n  if (!refreshStatus) return;\n\n  if (state === 'refreshing') {\n    refreshStatus.innerHTML = \"<span class='dot'></span>refreshing…\";\n    return;\n  }\n  if (state === 'paused') {\n    refreshStatus.innerHTML = \"<span class='dot'></span>paused\";\n    return;\n  }\n  if (state === 'error') {\n    refreshStatus.innerHTML = \"<span class='dot'></span>refresh failed\";\n    return;\n  }\n  const suffix = detail ? ` ${detail}` : '';\n  refreshStatus.innerHTML =\n    \"<span class='dot'></span>updated \" + new Date().toLocaleTimeString() + suffix;\n}\n\nfunction stopPolling() {\n  if (refreshTimer) {\n    clearInterval(refreshTimer);\n    refreshTimer = null;\n  }\n}\n\nfunction startPolling() {\n  if (refreshTimer) return;\n  refreshTimer = setInterval(() => {\n    refresh();\n  }, 5000);\n}\n\ndocument.addEventListener('visibilitychange', () => {\n  if (document.visibilityState === 'hidden') {\n    stopPolling();\n    setRefreshStatus('paused', '(tab hidden)');\n    return;\n  }\n  if (!isSettingsOpen()) {\n    startPolling();\n    refresh();\n  }\n});\n\nfunction isUserInteracting() {\n  const hovered = Boolean(document.querySelector('.feed-item:hover'));\n  const selection = window.getSelection?.();\n  const hasSelection = Boolean(selection && String(selection).trim());\n  return hovered || hasSelection;\n}\n\n\n\n// Theme management\nfunction getTheme() {\n  const saved = localStorage.getItem('opencode-mem-theme');\n  if (saved) return saved;\n  return window.matchMedia('(prefers-color-scheme: dark)').matches\n    ? 'dark'\n    : 'light';\n}\n\nfunction setTheme(theme: string) {\n  document.documentElement.setAttribute('data-theme', theme);\n  localStorage.setItem('opencode-mem-theme', theme);\n  if (themeToggle) {\n    themeToggle.innerHTML =\n      theme === 'dark'\n        ? '<i data-lucide=\"sun\"></i>'\n        : '<i data-lucide=\"moon\"></i>';\n    themeToggle.title =\n      theme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode';\n  }\n  if (typeof (globalThis as any).lucide !== 'undefined')\n    (globalThis as any).lucide.createIcons();\n}\n\nfunction toggleTheme() {\n  const current = getTheme();\n  setTheme(current === 'dark' ? 'light' : 'dark');\n}\n\n// Initialize theme\nsetTheme(getTheme());\nthemeToggle?.addEventListener('click', toggleTheme);\n\nsetSyncDiagnosticsOpen(isSyncDiagnosticsOpen());\ntry {\n  syncPairingOpen = localStorage.getItem(SYNC_PAIRING_KEY) === '1';\n} catch {\n  syncPairingOpen = false;\n}\nsetSyncPairingOpen(syncPairingOpen);\nsetSyncRedactionEnabled(isSyncRedactionEnabled());\n\nsyncDetailsToggle?.addEventListener('click', () => {\n  const next = !isSyncDiagnosticsOpen();\n  setSyncDiagnosticsOpen(next);\n  refresh();\n});\n\nsyncPairingToggle?.addEventListener('click', () => {\n  const next = !isSyncPairingOpen();\n  setSyncPairingOpen(next);\n  if (next) {\n    if (pairingPayload) pairingPayload.textContent = 'Loading…';\n    if (pairingHint) pairingHint.textContent = 'Fetching pairing payload…';\n  }\n  refresh();\n});\n\nsyncRedact?.addEventListener('change', () => {\n  setSyncRedactionEnabled(Boolean(syncRedact.checked));\n  renderSyncStatus(lastSyncStatus);\n  renderSyncPeers(lastSyncPeers);\n  renderSyncAttempts(lastSyncAttempts);\n  renderPairing(pairingPayloadRaw);\n});\n\nfeedTypeFilter = getFeedTypeFilter();\nupdateFeedTypeToggle();\nfeedTypeToggle?.addEventListener('click', (event) => {\n  const target = (event as any).target?.closest?.('button');\n  if (!target) return;\n  const value = target.dataset.filter || 'all';\n  setFeedTypeFilter(value);\n});\n\nfeedSearch?.addEventListener('input', () => {\n  feedQuery = feedSearch.value || '';\n  updateFeedView();\n});\n\nfunction formatDate(value: any) {\n  if (!value) return 'n/a';\n  const date = new Date(value);\n  return Number.isNaN(date.getTime()) ? String(value) : date.toLocaleString();\n}\n\nfunction formatPercent(value: any) {\n  const num = Number(value);\n  if (!Number.isFinite(num)) return 'n/a';\n  return `${Math.round(num * 100)}%`;\n}\n\nfunction formatMultiplier(saved: any, read: any) {\n  const savedNum = Number(saved || 0);\n  const readNum = Number(read || 0);\n  if (!Number.isFinite(savedNum) || !Number.isFinite(readNum) || readNum <= 0)\n    return 'n/a';\n  const factor = (savedNum + readNum) / readNum;\n  if (!Number.isFinite(factor) || factor <= 0) return 'n/a';\n  return `${factor.toFixed(factor >= 10 ? 0 : 1)}x`;\n}\n\nfunction formatReductionPercent(saved: any, read: any) {\n  const savedNum = Number(saved || 0);\n  const readNum = Number(read || 0);\n  if (!Number.isFinite(savedNum) || !Number.isFinite(readNum)) return 'n/a';\n  const total = savedNum + readNum;\n  if (total <= 0) return 'n/a';\n  const pct = savedNum / total;\n  if (!Number.isFinite(pct)) return 'n/a';\n  return `${Math.round(pct * 100)}%`;\n}\n\nfunction normalize(text: any) {\n  return String(text || '')\n    .replace(/\\s+/g, ' ')\n    .trim()\n    .toLowerCase();\n}\n\nfunction parseJsonArray(value: any) {\n  if (!value) return [];\n  if (Array.isArray(value)) return value;\n  if (typeof value === 'string') {\n    try {\n      const parsed = JSON.parse(value);\n      return Array.isArray(parsed) ? parsed : [];\n    } catch {\n      return [];\n    }\n  }\n  return [];\n}\n\nfunction getFeedTypeFilter() {\n  const saved = localStorage.getItem(FEED_FILTER_KEY) || 'all';\n  return FEED_FILTERS.includes(saved) ? saved : 'all';\n}\n\nfunction isSyncDiagnosticsOpen() {\n  return localStorage.getItem(SYNC_DIAGNOSTICS_KEY) === '1';\n}\n\nfunction setSyncDiagnosticsOpen(open: boolean) {\n  if (syncDiagnostics) {\n    (syncDiagnostics as any).hidden = !open;\n  }\n  if (syncDetailsToggle) {\n    syncDetailsToggle.textContent = open ? 'Hide diagnostics' : 'Diagnostics';\n  }\n  localStorage.setItem(SYNC_DIAGNOSTICS_KEY, open ? '1' : '0');\n}\n\nfunction isSyncPairingOpen() {\n  return syncPairingOpen;\n}\n\nfunction setSyncPairingOpen(open: boolean) {\n  syncPairingOpen = open;\n  if (syncPairing) {\n    (syncPairing as any).hidden = !open;\n  }\n  if (syncPairingToggle) {\n    syncPairingToggle.textContent = open ? 'Close' : 'Pair';\n  }\n  try {\n    localStorage.setItem(SYNC_PAIRING_KEY, open ? '1' : '0');\n  } catch {\n    // Ignore persistence errors.\n  }\n}\n\nfunction isSyncRedactionEnabled() {\n  const raw = localStorage.getItem(SYNC_REDACT_KEY);\n  return raw !== '0';\n}\n\nfunction setSyncRedactionEnabled(enabled: boolean) {\n  localStorage.setItem(SYNC_REDACT_KEY, enabled ? '1' : '0');\n  if (syncRedact) {\n    syncRedact.checked = enabled;\n  }\n}\n\nfunction setFeedTypeFilter(value: string) {\n  feedTypeFilter = FEED_FILTERS.includes(value) ? value : 'all';\n  localStorage.setItem(FEED_FILTER_KEY, feedTypeFilter);\n  updateFeedTypeToggle();\n  if (lastFeedItems.length) {\n    updateFeedView();\n  } else {\n    refresh();\n  }\n}\n\nfunction updateFeedTypeToggle() {\n  if (!feedTypeToggle) return;\n  const buttons = Array.from(feedTypeToggle.querySelectorAll('.toggle-button'));\n  buttons.forEach((button) => {\n    const value = (button as any).dataset?.filter || 'all';\n    button.classList.toggle('active', value === feedTypeFilter);\n  });\n}\n\nfunction filterFeedItems(items: any[]) {\n  if (feedTypeFilter === 'observations') {\n    return items.filter(\n      (item) => String(item.kind || '').toLowerCase() !== 'session_summary',\n    );\n  }\n  if (feedTypeFilter === 'summaries') {\n    return items.filter(\n      (item) => String(item.kind || '').toLowerCase() === 'session_summary',\n    );\n  }\n  return items;\n}\n\nfunction filterFeedQuery(items: any[]) {\n  const query = normalize(feedQuery);\n  if (!query) return items;\n  return items.filter((item) => {\n    const title = normalize(item?.title);\n    const body = normalize(item?.body_text);\n    const kind = normalize(item?.kind);\n    const tags = parseJsonArray(item?.tags || []).map((t) => normalize(t)).join(' ');\n    const project = normalize(item?.project);\n    const hay = `${title} ${body} ${kind} ${tags} ${project}`.trim();\n    return hay.includes(query);\n  });\n}\n\nfunction updateFeedView() {\n  const scrollY = window.scrollY;\n  const filteredByType = filterFeedItems(lastFeedItems);\n  const visibleItems = filterFeedQuery(filteredByType);\n  const filterLabel = formatFeedFilterLabel();\n\n  const signature = computeFeedSignature(visibleItems);\n  const changed = signature !== lastFeedSignature;\n  lastFeedSignature = signature;\n\n  if (feedMeta) {\n    const filteredLabel =\n      !feedQuery.trim() && lastFeedFilteredCount\n        ? ` · ${lastFeedFilteredCount} observations filtered`\n        : '';\n    const queryLabel = feedQuery.trim() ? ` · matching \"${feedQuery.trim()}\"` : '';\n    feedMeta.textContent = `${visibleItems.length} items${filterLabel}${queryLabel}${filteredLabel}`;\n  }\n  if (changed) {\n    renderFeed(visibleItems);\n  }\n  window.scrollTo({ top: scrollY });\n}\n\n\n\nfunction formatFeedFilterLabel() {\n  if (feedTypeFilter === 'observations') return ' · observations';\n  if (feedTypeFilter === 'summaries') return ' · session summaries';\n  return '';\n}\n\nfunction extractFactsFromBody(text: any) {\n  if (!text) return [];\n  const lines = String(text)\n    .split('\\n')\n    .map((line) => line.trim())\n    .filter(Boolean);\n  const bulletLines = lines.filter(\n    (line) => /^[-*\\u2022]\\s+/.test(line) || /^\\d+\\./.test(line),\n  );\n  if (!bulletLines.length) return [];\n  return bulletLines.map((line) =>\n    line.replace(/^[-*\\u2022]\\s+/, '').replace(/^\\d+\\.\\s+/, ''),\n  );\n}\n\nfunction isLowSignalObservation(item: any) {\n  const title = normalize(item.title);\n  const body = normalize(item.body_text);\n  if (!title && !body) return true;\n\n  const combined = body || title;\n  if (combined.length < 10) return true;\n  if (title && body && title === body && combined.length < 40) return true;\n\n  const leadGlyph = title.charAt(0);\n  const isPrompty = leadGlyph === '\\u2514' || leadGlyph === '\\u203a';\n  if (isPrompty && combined.length < 40) return true;\n\n  if (title.startsWith('list ') && combined.length < 20) return true;\n  if (combined === 'ls' || combined === 'list ls') return true;\n\n  return false;\n}\n\nfunction createElement(tag: string, className?: string | null, text?: any) {\n  const el = document.createElement(tag);\n  if (className) {\n    (el as any).className = className;\n  }\n  if (text !== undefined && text !== null) {\n    el.textContent = String(text);\n  }\n  return el;\n}\n\nfunction formatTagLabel(tag: any) {\n  if (!tag) return '';\n  const trimmed = String(tag).trim();\n  const colonIndex = trimmed.indexOf(':');\n  if (colonIndex === -1) return trimmed;\n  return trimmed.slice(0, colonIndex).trim();\n}\n\nfunction createTagChip(tag: any) {\n  const display = formatTagLabel(tag);\n  if (!display) return null;\n  const chip = createElement('span', 'tag-chip', display);\n  (chip as any).title = String(tag);\n  return chip;\n}\n\nfunction mergeMetadata(metadata: any) {\n  if (!metadata || typeof metadata !== 'object') {\n    return {};\n  }\n  const importMetadata = (metadata as any).import_metadata;\n  if (importMetadata && typeof importMetadata === 'object') {\n    return { ...(importMetadata as any), ...(metadata as any) };\n  }\n  return metadata;\n}\n\nfunction formatFileList(files: any[], limit = 2) {\n  if (!files.length) return '';\n  const trimmed = files.map((file) => String(file).trim()).filter(Boolean);\n  const slice = trimmed.slice(0, limit);\n  const suffix = trimmed.length > limit ? ` +${trimmed.length - limit}` : '';\n  return `${slice.join(', ')}${suffix}`.trim();\n}\n\nfunction renderStats(\n  stats: any,\n  usagePayload: any,\n  project: string,\n  rawEvents: any,\n) {\n  const db = stats.database || {};\n  const totalsGlobal =\n    usagePayload?.totals_global ||\n    usagePayload?.totals ||\n    stats.usage?.totals ||\n    {};\n  const totalsFiltered = usagePayload?.totals_filtered || null;\n  const isFiltered = !!(project && totalsFiltered);\n  const usage = isFiltered ? totalsFiltered : totalsGlobal;\n\n  const raw = rawEvents && typeof rawEvents === 'object' ? rawEvents : {};\n  const rawSessions = Number(raw.sessions || 0);\n  const rawPending = Number(raw.pending || 0);\n\n  const globalLineWork = isFiltered\n    ? `\\nGlobal: ${Number(totalsGlobal.work_investment_tokens || 0).toLocaleString()} invested`\n    : '';\n  const globalLineRead = isFiltered\n    ? `\\nGlobal: ${Number(totalsGlobal.tokens_read || 0).toLocaleString()} read`\n    : '';\n  const globalLineSaved = isFiltered\n    ? `\\nGlobal: ${Number(totalsGlobal.tokens_saved || 0).toLocaleString()} saved`\n    : '';\n\n  const items: Array<{\n    label: string;\n    value: any;\n    icon: string;\n    tooltip?: string;\n  }> = [\n    {\n      label: isFiltered ? 'Savings (project)' : 'Savings',\n      value: Number(usage.tokens_saved || 0),\n      tooltip:\n        'Tokens saved by reusing compressed memories instead of raw context' +\n        globalLineSaved,\n      icon: 'trending-up',\n    },\n    {\n      label: isFiltered ? 'Injected (project)' : 'Injected',\n      value: Number(usage.tokens_read || 0),\n      tooltip: 'Tokens injected into context (pack size)' + globalLineRead,\n      icon: 'book-open',\n    },\n    {\n      label: isFiltered ? 'Reduction (project)' : 'Reduction',\n      value: formatReductionPercent(usage.tokens_saved, usage.tokens_read),\n      tooltip:\n        'Percent reduction from reuse (claude-mem style). ' +\n        `Factor: ${formatMultiplier(usage.tokens_saved, usage.tokens_read)}.` +\n        globalLineRead +\n        globalLineSaved,\n      icon: 'percent',\n    },\n    {\n      label: isFiltered ? 'Work investment (project)' : 'Work investment',\n      value: Number(usage.work_investment_tokens || 0),\n      tooltip:\n        'Token cost of unique discovery groups (avoids double-counting when one response yields multiple memories)' +\n        globalLineWork,\n      icon: 'pencil',\n    },\n    {\n      label: 'Active memories',\n      value: db.active_memory_items || 0,\n      icon: 'check-circle',\n    },\n    {\n      label: 'Embedding coverage',\n      value: formatPercent(db.vector_coverage),\n      tooltip: 'Share of active memories with embeddings',\n      icon: 'layers',\n    },\n    {\n      label: 'Tag coverage',\n      value: formatPercent(db.tags_coverage),\n      tooltip: 'Share of active memories with tags',\n      icon: 'tag',\n    },\n  ];\n\n  if (rawPending > 0) {\n    items.push({\n      label: 'Raw events pending',\n      value: rawPending,\n      tooltip: 'Pending raw events waiting to be flushed',\n      icon: 'activity',\n    });\n  } else if (rawSessions > 0) {\n    items.push({\n      label: 'Raw sessions',\n      value: rawSessions,\n      tooltip: 'OpenCode sessions with pending raw events waiting to be flushed',\n      icon: 'inbox',\n    });\n  }\n\n  if (statsGrid) {\n    statsGrid.textContent = '';\n    items.forEach((item) => {\n      const stat = createElement('div', 'stat');\n      if ((item as any).tooltip) {\n        (stat as any).title = (item as any).tooltip;\n        (stat as any).style.cursor = 'help';\n      }\n      const icon = document.createElement('i');\n      icon.setAttribute('data-lucide', (item as any).icon);\n      (icon as any).className = 'stat-icon';\n      const content = createElement('div', 'stat-content');\n\n      const rawValue = (item as any).value;\n      const displayValue =\n        typeof rawValue === 'number'\n          ? rawValue.toLocaleString()\n          : rawValue === null || rawValue === undefined\n            ? 'n/a'\n            : String(rawValue);\n      const value = createElement(\n        'div',\n        'value',\n        displayValue,\n      );\n      const label = createElement('div', 'label', (item as any).label);\n      content.append(value, label);\n      stat.append(icon, content);\n      statsGrid.appendChild(stat);\n    });\n  }\n  if (typeof (globalThis as any).lucide !== 'undefined')\n    (globalThis as any).lucide.createIcons();\n  const projectSuffix = project ? ` · project: ${project}` : '';\n  if (metaLine) {\n    metaLine.textContent = `DB: ${db.path || 'unknown'} · ${Math.round(\n      (db.size_bytes || 0) / 1024,\n    )} KB${projectSuffix}`;\n  }\n}\n\nfunction formatTimestamp(value: any) {\n  if (!value) return 'never';\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) return String(value);\n  return date.toLocaleString();\n}\n\nfunction redactAddress(address: any) {\n  const raw = String(address || '');\n  if (!raw) return '';\n  let scheme = '';\n  let remainder = raw;\n  const schemeMatch = raw.match(/^(\\w+):\\/\\/([^/]+)(.*)$/);\n  if (schemeMatch) {\n    scheme = schemeMatch[1];\n    remainder = schemeMatch[2] + schemeMatch[3];\n  }\n  const redacted = remainder.replace(/\\d+/g, '#');\n  return scheme ? `${scheme}://${redacted}` : redacted;\n}\n\nfunction renderSyncStatus(status: any) {\n  if (!syncStatusGrid) return;\n  syncStatusGrid.textContent = '';\n  if (!status) return;\n\n  const peers = status.peers || {};\n  const pingPayload = status.ping || {};\n  const syncPayload = status.sync || {};\n  const lastSync = status.last_sync_at || status.last_sync_at_utc || null;\n  const lastPing = pingPayload.last_ping_at || status.last_ping_at || null;\n  const syncError = status.last_sync_error || '';\n  const pingError = status.last_ping_error || '';\n  const pending = Number(status.pending || 0);\n\n  const items = [\n    { label: 'Pending events', value: pending },\n    { label: 'Last sync', value: formatTimestamp(lastSync) },\n    { label: 'Last ping', value: formatTimestamp(lastPing) },\n    { label: 'Peers', value: Object.keys(peers).length },\n  ];\n  items.forEach((item) => {\n    const block = createElement('div', 'stat');\n    const value = createElement('div', 'value', item.value);\n    const label = createElement('div', 'label', item.label);\n    const content = createElement('div', 'stat-content');\n    content.append(value, label);\n    block.append(content);\n    syncStatusGrid.appendChild(block);\n  });\n\n  if (syncError || pingError) {\n    const block = createElement('div', 'stat');\n    const value = createElement('div', 'value', 'Errors');\n    const label = createElement(\n      'div',\n      'label',\n      [syncError, pingError].filter(Boolean).join(' · '),\n    );\n    const content = createElement('div', 'stat-content');\n    content.append(value, label);\n    block.append(content);\n    syncStatusGrid.appendChild(block);\n  }\n\n  if (syncPayload && syncPayload.seconds_since_last) {\n    const block = createElement('div', 'stat');\n    const value = createElement(\n      'div',\n      'value',\n      `${syncPayload.seconds_since_last}s`,\n    );\n    const label = createElement('div', 'label', 'Since last sync');\n    const content = createElement('div', 'stat-content');\n    content.append(value, label);\n    block.append(content);\n    syncStatusGrid.appendChild(block);\n  }\n\n  if (pingPayload && pingPayload.seconds_since_last) {\n    const block = createElement('div', 'stat');\n    const value = createElement(\n      'div',\n      'value',\n      `${pingPayload.seconds_since_last}s`,\n    );\n    const label = createElement('div', 'label', 'Since last ping');\n    const content = createElement('div', 'stat-content');\n    content.append(value, label);\n    block.append(content);\n    syncStatusGrid.appendChild(block);\n  }\n}\n\nfunction pickPrimaryAddress(addresses: unknown): string {\n  if (!Array.isArray(addresses)) return '';\n  const unique = Array.from(new Set(addresses.filter(Boolean)));\n  const first = unique[0];\n  return typeof first === 'string' ? first : '';\n}\n\nasync function syncNow(address: string, button?: HTMLButtonElement) {\n  const targetButton = button || syncNowButton;\n  if (!targetButton) return;\n  targetButton.disabled = true;\n  const prevLabel = targetButton.textContent;\n  targetButton.textContent = 'Syncing...';\n  try {\n    const payload = address ? { address } : {};\n    await fetch('/api/sync/run', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(payload),\n    });\n    refresh();\n  } catch {\n    // Ignore errors.\n  } finally {\n    targetButton.disabled = false;\n    targetButton.textContent = prevLabel || 'Sync now';\n  }\n}\n\nfunction renderSyncPeers(peers: any[]) {\n  if (!syncPeers) return;\n  syncPeers.textContent = '';\n  if (!Array.isArray(peers) || !peers.length) return;\n\n  peers.forEach((peer) => {\n    const card = createElement('div', 'peer-card');\n    const title = createElement('div', 'peer-title');\n    const peerId = peer.peer_device_id ? String(peer.peer_device_id) : '';\n    const displayName = peer.name || (peerId ? peerId.slice(0, 8) : 'unknown');\n    const name = createElement('strong', null, displayName);\n    if (peerId) (name as any).title = peerId;\n    const actions = createElement('div', 'peer-actions');\n\n    const status = peer.status || {};\n    const syncStatus = status.sync_status || '';\n    const pingStatus = status.ping_status || '';\n    const online = syncStatus === 'ok' || pingStatus === 'ok';\n    const statusBadge = createElement(\n      'span',\n      'badge',\n      online ? 'Online' : 'Offline',\n    );\n    (statusBadge as any).style.background = online\n      ? 'rgba(31, 111, 92, 0.12)'\n      : 'rgba(230, 126, 77, 0.15)';\n    (statusBadge as any).style.color = online\n      ? 'var(--accent)'\n      : 'var(--accent-2)';\n    name.append(' ', statusBadge);\n\n    const peerAddresses = Array.isArray(peer.addresses)\n      ? Array.from(new Set(peer.addresses.filter(Boolean)))\n      : [];\n    const addressLine = peerAddresses.length\n      ? peerAddresses\n          .map((address) =>\n            isSyncRedactionEnabled() ? redactAddress(address) : address,\n          )\n          .join(' · ')\n      : 'No addresses';\n    const addressLabel = createElement('div', 'peer-addresses', addressLine);\n\n    const lastSyncAt = status.last_sync_at || status.last_sync_at_utc || '';\n    const lastPingAt = status.last_ping_at || status.last_ping_at_utc || '';\n    const metaLine = [\n      lastSyncAt ? `Sync: ${formatTimestamp(lastSyncAt)}` : 'Sync: never',\n      lastPingAt ? `Ping: ${formatTimestamp(lastPingAt)}` : 'Ping: never',\n    ].join(' · ');\n    const meta = createElement('div', 'peer-meta', metaLine);\n\n    const primaryAddress = pickPrimaryAddress(peer.addresses);\n    const button = createElement('button', null, 'Sync now') as HTMLButtonElement;\n    button.disabled = !primaryAddress;\n    button.addEventListener('click', () => syncNow(primaryAddress, button));\n    actions.appendChild(button);\n\n    title.append(name, actions);\n    card.append(title, addressLabel, meta);\n    syncPeers.appendChild(card);\n  });\n}\n\nfunction renderSyncAttempts(attempts: any[]) {\n  if (!syncAttempts) return;\n  syncAttempts.textContent = '';\n  if (!Array.isArray(attempts) || !attempts.length) return;\n\n  attempts.forEach((attempt) => {\n    const line = createElement('div', 'diag-line');\n    const left = createElement('div', 'left');\n    const right = createElement('div', 'right');\n\n    const attemptStatus = attempt.status || 'unknown';\n    const status = createElement('div', null, attemptStatus);\n    const address = attempt.address ? String(attempt.address) : '';\n    const redacted = isSyncRedactionEnabled()\n      ? redactAddress(address)\n      : address;\n    const addressLabel = createElement('div', 'small', redacted || 'n/a');\n    left.append(status, addressLabel);\n\n    const time = attempt.started_at || attempt.started_at_utc || '';\n    right.textContent = time ? formatTimestamp(time) : '';\n\n    line.append(left, right);\n    syncAttempts.appendChild(line);\n  });\n}\n\nfunction renderSyncHealth(syncHealth: any) {\n  if (!syncHealthGrid) return;\n  syncHealthGrid.textContent = '';\n  const health = syncHealth || {};\n  const title = createElement('div', 'stat');\n  const value = createElement('div', 'value', health.status || 'unknown');\n  const label = createElement('div', 'label', 'Sync status');\n  const content = createElement('div', 'stat-content');\n  content.append(value, label);\n  title.append(content);\n  syncHealthGrid.append(title);\n  if (health.details) {\n    const detail = createElement('div', 'stat');\n    const detailValue = createElement('div', 'value', health.details);\n    const detailLabel = createElement('div', 'label', 'Details');\n    const detailContent = createElement('div', 'stat-content');\n    detailContent.append(detailValue, detailLabel);\n    detail.append(detailContent);\n    syncHealthGrid.append(detail);\n  }\n}\n\nfunction renderPairing(payload: any) {\n  if (!pairingPayload) return;\n  if (!payload || typeof payload !== 'object') {\n    pairingPayload.textContent = 'Pairing not available';\n    if (pairingHint)\n      pairingHint.textContent =\n        'Enable sync and retry. (If you just enabled sync, wait a moment and refresh.)';\n    pairingCommandRaw = '';\n    return;\n  }\n\n  if (payload.redacted) {\n    pairingPayload.textContent = 'Pairing payload hidden';\n    if (pairingHint)\n      pairingHint.textContent =\n        'Diagnostics are required to view the pairing payload.';\n    pairingCommandRaw = '';\n    return;\n  }\n\n  const addresses = Array.isArray(payload.addresses) ? payload.addresses : [];\n  const safePayload = {\n    ...payload,\n    addresses: isSyncRedactionEnabled()\n      ? addresses.map((address: any) => redactAddress(address))\n      : addresses,\n    public_key: isSyncRedactionEnabled() ? '[redacted]' : payload.public_key,\n  };\n\n  const pretty = JSON.stringify(safePayload, null, 2);\n  pairingPayload.textContent = pretty;\n  pairingCommandRaw = pretty;\n  if (pairingHint) {\n    pairingHint.textContent = 'Copy this payload and paste it into opencode-mem on the other device.';\n  }\n}\n\nasync function copyPairingCommand() {\n  const command = pairingCommandRaw || pairingPayload?.textContent || '';\n  if (!command) return;\n  try {\n    await navigator.clipboard.writeText(command);\n    if (pairingCopy) pairingCopy.textContent = 'Copied';\n    setTimeout(() => {\n      if (pairingCopy) pairingCopy.textContent = 'Copy pairing payload';\n    }, 1200);\n  } catch {\n    if (pairingCopy) pairingCopy.textContent = 'Copy failed';\n  }\n}\n\npairingCopy?.addEventListener('click', copyPairingCommand);\n\nfunction itemSignature(item: any) {\n  return String(\n    item.id ??\n      item.memory_id ??\n      item.observation_id ??\n      item.session_id ??\n      item.created_at_utc ??\n      item.created_at ??\n      '',\n  );\n}\n\ntype ItemViewMode = 'summary' | 'facts' | 'narrative';\n\nfunction itemKey(item: any) {\n  return `${String(item.kind || '').toLowerCase()}:${itemSignature(item)}`;\n}\n\nfunction toTitleLabel(value: string) {\n  return value\n    .replace(/_/g, ' ')\n    .split(' ')\n    .map((part) => (part ? part[0].toUpperCase() + part.slice(1) : part))\n    .join(' ')\n    .trim();\n}\n\nfunction getSummaryObject(item: any): Record<string, any> | null {\n  const preferredKeys = [\n    'request',\n    'outcome',\n    'plan',\n    'completed',\n    'learned',\n    'investigated',\n    'next',\n    'next_steps',\n    'notes',\n  ];\n  const looksLikeSummary = (value: any) => {\n    if (!value || typeof value !== 'object' || Array.isArray(value)) return false;\n    return preferredKeys.some((key) => {\n      const raw = (value as any)[key];\n      return typeof raw === 'string' && raw.trim().length > 0;\n    });\n  };\n\n  const candidate = item?.summary;\n  if (candidate && typeof candidate === 'object' && !Array.isArray(candidate)) {\n    return candidate;\n  }\n  const nested = item?.summary?.summary;\n  if (nested && typeof nested === 'object' && !Array.isArray(nested)) {\n    return nested;\n  }\n\n  const metadata = item?.metadata_json;\n  if (looksLikeSummary(metadata)) {\n    return metadata;\n  }\n  const metadataNested = metadata?.summary;\n  if (looksLikeSummary(metadataNested)) {\n    return metadataNested;\n  }\n  return null;\n}\n\nfunction getNarrativeText(item: any) {\n  const html = item?.body_html;\n  const text = item?.body_text;\n  return String(html || text || '').trim();\n}\n\nfunction getFactsList(item: any) {\n  const summary = getSummaryObject(item);\n  if (summary) {\n    const preferred = [\n      'request',\n      'outcome',\n      'plan',\n      'completed',\n      'learned',\n      'investigated',\n      'next',\n      'next_steps',\n      'notes',\n    ];\n    const keys = Object.keys(summary || {});\n    const remaining = keys\n      .filter((key) => !preferred.includes(key))\n      .sort((a, b) => a.localeCompare(b));\n    const ordered = [...preferred.filter((key) => keys.includes(key)), ...remaining];\n\n    const facts: string[] = [];\n    ordered.forEach((key) => {\n      const raw = (summary as any)[key];\n      const content = String(raw || '').trim();\n      if (!content) return;\n\n      const bullets = extractFactsFromBody(content);\n      if (bullets.length) {\n        bullets.forEach((bullet) => {\n          facts.push(`${toTitleLabel(key)}: ${bullet}`.trim());\n        });\n        return;\n      }\n\n      facts.push(`${toTitleLabel(key)}: ${content}`.trim());\n    });\n    return facts;\n  }\n\n  const text = String(item?.body_text || '');\n  return extractFactsFromBody(text);\n}\n\nfunction renderSummaryObject(summary: Record<string, any>): HTMLElement | null {\n  const preferred = [\n    'request',\n    'outcome',\n    'plan',\n    'completed',\n    'learned',\n    'investigated',\n    'next',\n    'next_steps',\n    'notes',\n  ];\n  const keys = Object.keys(summary || {});\n  const ordered = preferred.filter((key) => keys.includes(key));\n\n  const container = createElement('div', 'feed-body facts') as HTMLDivElement;\n  let wrote = false;\n  ordered.forEach((key) => {\n    const raw = (summary as any)[key];\n    const content = String(raw || '').trim();\n    if (!content) return;\n    wrote = true;\n    const row = createElement('div', 'summary-section') as HTMLDivElement;\n    const label = createElement('div', 'summary-section-label', toTitleLabel(key));\n    const value = createElement('div', 'summary-section-content');\n    try {\n      value.innerHTML = (globalThis as any).marked.parse(content);\n    } catch {\n      value.textContent = content;\n    }\n    row.append(label, value);\n    container.appendChild(row);\n  });\n  return wrote ? container : null;\n}\n\nfunction renderFacts(facts: string[]): HTMLElement | null {\n  const trimmed = facts.map((fact) => String(fact || '').trim()).filter(Boolean);\n  if (!trimmed.length) return null;\n  const container = createElement('div', 'feed-body') as HTMLDivElement;\n  const list = document.createElement('ul');\n  trimmed.forEach((fact) => {\n    const li = document.createElement('li');\n    li.textContent = fact;\n    list.appendChild(li);\n  });\n  container.appendChild(list);\n  return container;\n}\n\nfunction renderNarrative(narrative: string): HTMLElement | null {\n  const content = String(narrative || '').trim();\n  if (!content) return null;\n  const body = createElement('div', 'feed-body') as HTMLDivElement;\n  body.innerHTML = (globalThis as any).marked.parse(content);\n  return body;\n}\n\nfunction _sentenceFacts(text: string, limit = 6): string[] {\n  const raw = String(text || '').trim();\n  if (!raw) return [];\n  const collapsed = raw.replace(/\\s+/g, ' ').trim();\n  const parts = collapsed\n    .split(/(?<=[.!?])\\s+/)\n    .map((part) => part.trim())\n    .filter(Boolean);\n\n  const facts: string[] = [];\n  for (const part of parts) {\n    if (part.length < 18) continue;\n    facts.push(part);\n    if (facts.length >= limit) break;\n  }\n  return facts;\n}\n\nfunction _observationViewData(item: any) {\n  const metadata = mergeMetadata(item?.metadata_json);\n  const summary = String(item?.subtitle || item?.body_text || '').trim();\n  const narrative = String(item?.narrative || metadata?.narrative || '').trim();\n  const normalizedSummary = normalize(summary);\n  const normalizedNarrative = normalize(narrative);\n  const narrativeDistinct = Boolean(narrative) && normalizedNarrative !== normalizedSummary;\n  const explicitFacts = parseJsonArray(item?.facts || metadata?.facts || []);\n  const fallbackFacts = explicitFacts.length\n    ? explicitFacts\n    : extractFactsFromBody(summary || narrative);\n  const derivedFacts = fallbackFacts.length ? fallbackFacts : _sentenceFacts(summary);\n  return {\n    summary,\n    narrative,\n    facts: derivedFacts,\n    hasSummary: Boolean(summary),\n    hasFacts: derivedFacts.length > 0,\n    hasNarrative: narrativeDistinct,\n  };\n}\n\nfunction _observationViewModes(data: {\n  hasSummary: boolean;\n  hasFacts: boolean;\n  hasNarrative: boolean;\n}): Array<{ id: ItemViewMode; label: string }> {\n  const modes: Array<{ id: ItemViewMode; label: string }> = [];\n  if (data.hasSummary) modes.push({ id: 'summary', label: 'Summary' });\n  if (data.hasFacts) modes.push({ id: 'facts', label: 'Facts' });\n  if (data.hasNarrative) modes.push({ id: 'narrative', label: 'Narrative' });\n  return modes;\n}\n\nfunction _defaultObservationView(data: {\n  hasSummary: boolean;\n  hasFacts: boolean;\n  hasNarrative: boolean;\n}): ItemViewMode {\n  if (data.hasSummary) return 'summary';\n  if (data.hasFacts) return 'facts';\n  return 'narrative';\n}\n\nfunction _renderObservationBody(\n  data: { summary: string; narrative: string; facts: string[] },\n  mode: ItemViewMode,\n): HTMLElement {\n  if (mode === 'facts') {\n    return renderFacts(data.facts) || createElement('div', 'feed-body');\n  }\n  if (mode === 'narrative') {\n    return renderNarrative(data.narrative) || createElement('div', 'feed-body');\n  }\n  return renderNarrative(data.summary) || createElement('div', 'feed-body');\n}\n\nfunction renderItemViewToggle(\n  modes: Array<{ id: ItemViewMode; label: string }>,\n  active: ItemViewMode,\n  onSelect: (mode: ItemViewMode) => void,\n): HTMLElement | null {\n  if (modes.length <= 1) return null;\n  const toggle = createElement('div', 'feed-toggle') as HTMLDivElement;\n  modes.forEach((mode) => {\n    const button = createElement(\n      'button',\n      'toggle-button',\n      mode.label,\n    ) as HTMLButtonElement;\n    button.dataset.filter = mode.id;\n    button.classList.toggle('active', mode.id === active);\n    button.addEventListener('click', () => onSelect(mode.id));\n    toggle.appendChild(button);\n  });\n  return toggle;\n}\n\nfunction shouldClampBody(\n  mode: ItemViewMode,\n  data: { summary: string; narrative: string },\n) {\n  if (mode === 'facts') return false;\n  if (mode === 'summary') return data.summary.length > 260;\n  return data.narrative.length > 320;\n}\n\nfunction clampClass(mode: ItemViewMode) {\n  if (mode === 'summary') return ['clamp', 'clamp-3'];\n  return ['clamp', 'clamp-5'];\n}\n\nfunction computeFeedSignature(items: any[]) {\n  const parts = items.map(\n    (item) =>\n      `${itemSignature(item)}:${item.kind || ''}:${item.created_at_utc || item.created_at || ''}`,\n  );\n  return `${feedTypeFilter}|${currentProject}|${parts.join('|')}`;\n}\n\nfunction countNewItems(nextItems: any[], currentItems: any[]) {\n  const seen = new Set(currentItems.map(itemKey));\n  let count = 0;\n  nextItems.forEach((item) => {\n    if (!seen.has(itemKey(item))) count += 1;\n  });\n  return count;\n}\n\nfunction escapeHtml(value: string) {\n  return value\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nfunction escapeRegExp(value: string) {\n  return value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nfunction highlightText(text: string, query: string) {\n  const q = query.trim();\n  if (!q) return escapeHtml(text);\n  const safe = escapeHtml(text);\n  try {\n    const re = new RegExp(`(${escapeRegExp(q)})`, 'ig');\n    return safe.replace(re, '<mark class=\"match\">$1</mark>');\n  } catch {\n    return safe;\n  }\n}\n\nfunction formatRelativeTime(value: any) {\n  if (!value) return 'n/a';\n  const date = new Date(value);\n  const ms = date.getTime();\n  if (Number.isNaN(ms)) return String(value);\n  const diff = Date.now() - ms;\n  const seconds = Math.round(diff / 1000);\n  if (seconds < 10) return 'just now';\n  if (seconds < 60) return `${seconds}s ago`;\n  const minutes = Math.round(seconds / 60);\n  if (minutes < 60) return `${minutes}m ago`;\n  const hours = Math.round(minutes / 60);\n  if (hours < 24) return `${hours}h ago`;\n  const days = Math.round(hours / 24);\n  if (days < 14) return `${days}d ago`;\n  return date.toLocaleDateString();\n}\n\nfunction renderFeed(items: any[]) {\n  if (!feedList) return;\n  feedList.textContent = '';\n  if (!Array.isArray(items) || !items.length) {\n    const empty = createElement('div', 'small', 'No memories yet.');\n    feedList.appendChild(empty);\n    return;\n  }\n  items.forEach((item) => {\n    const kindValue = String(item.kind || 'session_summary').toLowerCase();\n    const isSessionSummary = kindValue === 'session_summary';\n    const metadata = mergeMetadata(item?.metadata_json);\n\n    const card = createElement(\n      'div',\n      `feed-item ${kindValue}`.trim(),\n    );\n    const rowKey = itemKey(item);\n    (card as any).dataset.key = rowKey;\n    if (newItemKeys.has(rowKey)) {\n      card.classList.add('new-item');\n      setTimeout(() => {\n        card.classList.remove('new-item');\n        newItemKeys.delete(rowKey);\n      }, 700);\n    }\n    const header = createElement('div', 'feed-card-header');\n    const titleWrap = createElement('div', 'feed-header');\n    const defaultTitle = item.title || '(untitled)';\n    const displayTitle = isSessionSummary && metadata?.request ? metadata.request : defaultTitle;\n    const title = createElement('div', 'feed-title title');\n    (title as any).innerHTML = highlightText(displayTitle, feedQuery);\n    const kind = createElement(\n      'span',\n      `kind-pill ${kindValue}`.trim(),\n      kindValue.replace(/_/g, ' '),\n    );\n    titleWrap.append(kind, title);\n\n    const rightWrap = createElement('div', 'feed-actions');\n\n    const createdAtRaw = item.created_at || item.created_at_utc;\n    const createdAt = formatDate(createdAtRaw);\n    const relative = formatRelativeTime(createdAtRaw);\n    const age = createElement('div', 'small feed-age', relative);\n    (age as any).title = createdAt;\n\n    const footerRight = createElement('div', 'feed-footer-right');\n\n    let bodyNode: HTMLElement = createElement('div', 'feed-body');\n\n    if (isSessionSummary) {\n      const summaryObject = getSummaryObject({ metadata_json: metadata });\n      const rendered = summaryObject ? renderSummaryObject(summaryObject) : null;\n      bodyNode = rendered || renderNarrative(String(item.body_text || '')) || bodyNode;\n    } else {\n      const data = _observationViewData({ ...item, metadata_json: metadata });\n      const modes = _observationViewModes(data);\n      const defaultView = _defaultObservationView(data);\n\n      const key = itemKey(item);\n      const stored = itemViewState.get(key) as ItemViewMode | undefined;\n      let activeMode: ItemViewMode = stored && modes.some((m) => m.id === stored) ? stored : defaultView;\n      itemViewState.set(key, activeMode);\n\n      bodyNode = _renderObservationBody(data, activeMode);\n\n      const setExpandControl = (mode: ItemViewMode) => {\n        footerRight.textContent = '';\n        const expandKey = `${key}:${mode}`;\n        const expanded = itemExpandState.get(expandKey) === true;\n        const canClamp = shouldClampBody(mode, data);\n        if (!canClamp) return;\n\n        const button = createElement(\n          'button',\n          'feed-expand',\n          expanded ? 'Collapse' : 'Expand',\n        ) as HTMLButtonElement;\n        button.addEventListener('click', () => {\n          const next = !(itemExpandState.get(expandKey) === true);\n          itemExpandState.set(expandKey, next);\n          if (next) {\n            bodyNode.classList.remove('clamp', 'clamp-3', 'clamp-5');\n            button.textContent = 'Collapse';\n          } else {\n            bodyNode.classList.add(...clampClass(mode));\n            button.textContent = 'Expand';\n          }\n        });\n        footerRight.appendChild(button);\n      };\n\n      const expandKey = `${key}:${activeMode}`;\n      const expanded = itemExpandState.get(expandKey) === true;\n      const canClamp = shouldClampBody(activeMode, data);\n      if (canClamp && !expanded) {\n        bodyNode.classList.add(...clampClass(activeMode));\n      }\n\n      setExpandControl(activeMode);\n\n      const toggle = renderItemViewToggle(modes, activeMode, (mode) => {\n        activeMode = mode;\n        itemViewState.set(key, mode);\n        const nextBody = _renderObservationBody(data, mode);\n\n        const nextExpandKey = `${key}:${mode}`;\n        const nextExpanded = itemExpandState.get(nextExpandKey) === true;\n        const nextCanClamp = shouldClampBody(mode, data);\n        if (nextCanClamp && !nextExpanded) {\n          nextBody.classList.add(...clampClass(mode));\n        }\n\n        card.replaceChild(nextBody, bodyNode);\n        bodyNode = nextBody;\n\n        setExpandControl(mode);\n\n        if (toggle) {\n          const buttons = Array.from(toggle.querySelectorAll('.toggle-button'));\n          buttons.forEach((button) => {\n            const value = (button as HTMLButtonElement).dataset.filter as ItemViewMode;\n            button.classList.toggle('active', value === mode);\n          });\n        }\n      });\n      if (toggle) rightWrap.appendChild(toggle);\n    }\n    rightWrap.appendChild(age);\n\n    header.append(titleWrap, rightWrap);\n\n    const meta = createElement('div', 'feed-meta');\n    const tags = parseJsonArray(item.tags || []);\n    const files = parseJsonArray(item.files || []);\n    const project = item.project || '';\n    const tagContent = tags.length\n      ? ` · ${tags.map((tag) => formatTagLabel(tag)).join(', ')}`\n      : '';\n    const fileContent = files.length ? ` · ${formatFileList(files)}` : '';\n    const projectContent = project ? `Project: ${project}` : 'Project: n/a';\n    meta.textContent = `${projectContent}${tagContent}${fileContent}`;\n\n    const footer = createElement('div', 'feed-footer');\n    const footerLeft = createElement('div', 'feed-footer-left');\n    const filesWrap = createElement('div', 'feed-files');\n    const tagsWrap = createElement('div', 'feed-tags');\n\n    files.forEach((file: any) => {\n      const chip = createElement('span', 'feed-file', file);\n      filesWrap.appendChild(chip);\n    });\n\n    tags.forEach((tag: any) => {\n      const chip = createTagChip(tag);\n      if (chip) tagsWrap.appendChild(chip);\n    });\n\n    if (filesWrap.childElementCount) {\n      footerLeft.appendChild(filesWrap);\n    }\n    if (tagsWrap.childElementCount) {\n      footerLeft.appendChild(tagsWrap);\n    }\n    footer.append(footerLeft, footerRight);\n\n    card.append(header, meta, bodyNode, footer);\n    feedList.appendChild(card);\n  });\n  if (typeof (globalThis as any).lucide !== 'undefined')\n    (globalThis as any).lucide.createIcons();\n}\n\nfunction renderSessionSummary(summary: any, usagePayload: any, project: string) {\n  if (!sessionGrid || !sessionMeta) return;\n  sessionGrid.textContent = '';\n  if (!summary) {\n    sessionMeta.textContent = 'No injections yet';\n    return;\n  }\n\n  const total = Number(summary.total || 0);\n  const totalsGlobal = usagePayload?.totals_global || usagePayload?.totals || {};\n  const totalsFiltered = usagePayload?.totals_filtered || null;\n  const isFiltered = !!(project && totalsFiltered);\n  const usage = isFiltered ? totalsFiltered : totalsGlobal;\n\n  const events = Array.isArray(usagePayload?.events) ? usagePayload.events : [];\n  const packEvent = events.find((evt: any) => String(evt?.event || '') === 'pack') || null;\n  const recentEvent = events.find((evt: any) => String(evt?.event || '') === 'recent') || null;\n  const recentKindsEvent = events.find((evt: any) => String(evt?.event || '') === 'recent_kinds') || null;\n  const searchEvent = events.find((evt: any) => String(evt?.event || '') === 'search') || null;\n  const packCount = Number(packEvent?.count || 0);\n  const recentPacks = Array.isArray(usagePayload?.recent_packs)\n    ? usagePayload.recent_packs\n    : [];\n  const latestPack = recentPacks.length ? recentPacks[0] : null;\n  const lastPackAt = latestPack?.created_at || '';\n\n  const packTokens = Number(latestPack?.tokens_read || 0);\n  const savedTokens = Number(latestPack?.tokens_saved || 0);\n  const reductionPercent = formatReductionPercent(savedTokens, packTokens);\n\n  const packLine = packCount ? `${packCount} packs` : 'No packs yet';\n  const lastPackLine = lastPackAt ? `Last pack: ${formatTimestamp(lastPackAt)}` : '';\n  const scopeLabel = isFiltered ? 'Project' : 'All projects';\n  sessionMeta.textContent = [scopeLabel, packLine, lastPackLine]\n    .filter(Boolean)\n    .join(' · ');\n\n  const scopeSuffix = isFiltered ? ' (project)' : '';\n  const usageDetails = [\n    packEvent ? `pack${scopeSuffix}: ${Number(packEvent.count || 0)} events` : null,\n    searchEvent ? `search${scopeSuffix}: ${Number(searchEvent.count || 0)} events` : null,\n    recentEvent ? `recent${scopeSuffix}: ${Number(recentEvent.count || 0)} gets` : null,\n    recentKindsEvent ? `recent_kinds${scopeSuffix}: ${Number(recentKindsEvent.count || 0)} gets` : null,\n  ]\n    .filter(Boolean)\n    .join(' · ');\n\n  const items: Array<{ label: string; value: any; icon: string }> = [\n    {\n      label: 'Last pack savings',\n      value: latestPack\n        ? `${savedTokens.toLocaleString()} (${reductionPercent})`\n        : 'n/a',\n      icon: 'trending-up',\n    },\n    {\n      label: 'Last pack size',\n      value: latestPack ? packTokens.toLocaleString() : 'n/a',\n      icon: 'package',\n    },\n    {\n      label: 'Packs',\n      value: packCount || 0,\n      icon: 'archive',\n    },\n  ];\n\n  if (sessionGrid && usageDetails) {\n    (sessionGrid as any).title = usageDetails;\n    (sessionGrid as any).style.cursor = 'help';\n  }\n  items.forEach((item) => {\n    const block = createElement('div', 'stat');\n    const icon = document.createElement('i');\n    icon.setAttribute('data-lucide', (item as any).icon);\n    (icon as any).className = 'stat-icon';\n    const rawValue = (item as any).value;\n    const displayValue =\n      typeof rawValue === 'number'\n        ? rawValue.toLocaleString()\n        : rawValue === null || rawValue === undefined\n          ? 'n/a'\n          : String(rawValue);\n    const value = createElement(\n      'div',\n      'value',\n      displayValue,\n    );\n    const label = createElement('div', 'label', item.label);\n    const content = createElement('div', 'stat-content');\n    content.append(value, label);\n    block.append(icon, content);\n    sessionGrid.appendChild(block);\n  });\n\n  if (typeof (globalThis as any).lucide !== 'undefined')\n    (globalThis as any).lucide.createIcons();\n}\n\nfunction renderConfigModal(payload: any) {\n  if (!payload || typeof payload !== 'object') return;\n  const defaults = payload.defaults || {};\n  const config = payload.config || {};\n  configDefaults = defaults;\n  configPath = payload.path || '';\n\n  const observerProvider = config.observer_provider || '';\n  const observerModel = config.observer_model || '';\n  const observerMaxChars = config.observer_max_chars || '';\n  const packObservationLimit = config.pack_observation_limit || '';\n  const packSessionLimit = config.pack_session_limit || '';\n  const syncEnabled = config.sync_enabled || false;\n  const syncHost = config.sync_host || '';\n  const syncPort = config.sync_port || '';\n  const syncInterval = config.sync_interval_s || '';\n  const syncMdns = config.sync_mdns || false;\n\n  if (observerProviderInput) observerProviderInput.value = observerProvider;\n  if (observerModelInput) observerModelInput.value = observerModel;\n  if (observerMaxCharsInput) observerMaxCharsInput.value = observerMaxChars;\n  if (packObservationLimitInput)\n    packObservationLimitInput.value = packObservationLimit;\n  if (packSessionLimitInput) packSessionLimitInput.value = packSessionLimit;\n  if (syncEnabledInput) syncEnabledInput.checked = Boolean(syncEnabled);\n  if (syncHostInput) syncHostInput.value = syncHost;\n  if (syncPortInput) syncPortInput.value = syncPort;\n  if (syncIntervalInput) syncIntervalInput.value = syncInterval;\n  if (syncMdnsInput) syncMdnsInput.checked = Boolean(syncMdns);\n\n  if (settingsPath)\n    settingsPath.textContent = configPath\n      ? `Config path: ${configPath}`\n      : 'Config path: n/a';\n  if (observerMaxCharsHint) {\n    const defaultValue = configDefaults?.observer_max_chars || '';\n    observerMaxCharsHint.textContent = defaultValue\n      ? `Default: ${defaultValue}`\n      : '';\n  }\n  if (settingsEffective) {\n    const hasOverrides = Boolean(payload.env_overrides);\n    settingsEffective.textContent = hasOverrides\n      ? 'Effective config differs (env overrides active)'\n      : '';\n  }\n\n  setSettingsDirty(false);\n  if (settingsStatus) settingsStatus.textContent = 'Ready';\n}\n\nfunction openSettings() {\n  stopPolling();\n  setRefreshStatus('paused', '(settings)');\n  if (settingsBackdrop) (settingsBackdrop as any).hidden = false;\n  if (settingsModal) (settingsModal as any).hidden = false;\n}\n\nfunction closeSettings() {\n  if (settingsDirty) {\n    const ok = globalThis.confirm('Discard unsaved changes?');\n    if (!ok) return;\n  }\n  if (settingsBackdrop) (settingsBackdrop as any).hidden = true;\n  if (settingsModal) (settingsModal as any).hidden = true;\n  startPolling();\n  refresh();\n}\n\nsettingsButton?.addEventListener('click', openSettings);\nsettingsClose?.addEventListener('click', closeSettings);\nsettingsBackdrop?.addEventListener('click', closeSettings);\nsettingsModal?.addEventListener('click', (event) => {\n  if (event.target === settingsModal) {\n    closeSettings();\n  }\n});\n\n[\n  observerProviderInput,\n  observerModelInput,\n  observerMaxCharsInput,\n  packObservationLimitInput,\n  packSessionLimitInput,\n  syncEnabledInput,\n  syncHostInput,\n  syncPortInput,\n  syncIntervalInput,\n  syncMdnsInput,\n].forEach((input) => {\n  if (!input) return;\n  input.addEventListener('input', () => setSettingsDirty(true));\n  input.addEventListener('change', () => setSettingsDirty(true));\n});\n\nsyncNowButton?.addEventListener('click', () => syncNow(''));\n\nfunction hideSettingsOverrideNotice(config: any) {\n  if (!settingsOverrides) return;\n  if (config?.has_env_overrides) {\n    (settingsOverrides as any).hidden = false;\n  } else {\n    (settingsOverrides as any).hidden = true;\n  }\n}\n\nasync function saveSettings() {\n  if (!settingsSave || !settingsStatus) return;\n  (settingsSave as any).disabled = true;\n  settingsStatus.textContent = 'Saving...';\n  try {\n    const payload = {\n      observer_provider: observerProviderInput?.value || '',\n      observer_model: observerModelInput?.value || '',\n      observer_max_chars: Number(observerMaxCharsInput?.value || 0) || '',\n      pack_observation_limit:\n        Number(packObservationLimitInput?.value || 0) || '',\n      pack_session_limit: Number(packSessionLimitInput?.value || 0) || '',\n      sync_enabled: syncEnabledInput?.checked || false,\n      sync_host: syncHostInput?.value || '',\n      sync_port: Number(syncPortInput?.value || 0) || '',\n      sync_interval_s: Number(syncIntervalInput?.value || 0) || '',\n      sync_mdns: syncMdnsInput?.checked || false,\n    };\n    const resp = await fetch('/api/config', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(payload),\n    });\n    if (!resp.ok) {\n      const message = await resp.text();\n      throw new Error(message);\n    }\n    settingsStatus.textContent = 'Saved';\n    setSettingsDirty(false);\n    closeSettings();\n  } catch {\n    settingsStatus.textContent = 'Save failed';\n  } finally {\n    (settingsSave as any).disabled = !settingsDirty;\n  }\n}\n\nsettingsSave?.addEventListener('click', saveSettings);\n\nasync function loadStats() {\n  try {\n    const [statsResp, usageResp, sessionsResp, rawEventsResp] =\n      await Promise.all([\n        fetch('/api/stats'),\n        fetch(`/api/usage?project=${encodeURIComponent(currentProject || '')}`),\n        fetch(\n          `/api/session?project=${encodeURIComponent(currentProject || '')}`,\n        ),\n        fetch(\n          `/api/raw-events?project=${encodeURIComponent(currentProject || '')}`,\n        ),\n      ]);\n\n    const statsPayload = await statsResp.json();\n    const usagePayload = usageResp.ok ? await usageResp.json() : {};\n    const sessionsPayload = sessionsResp.ok ? await sessionsResp.json() : {};\n    const rawEventsPayload = rawEventsResp.ok ? await rawEventsResp.json() : {};\n\n    const stats = statsPayload || {};\n    const sessions = sessionsPayload || {};\n    const rawEvents = rawEventsPayload || {};\n\n    renderStats(stats, usagePayload, currentProject, rawEvents);\n    renderSessionSummary(sessions, usagePayload, currentProject);\n    renderSyncHealth(stats.sync_health || {});\n  } catch {\n    if (metaLine) metaLine.textContent = 'Stats unavailable';\n  }\n}\n\nasync function loadFeed() {\n  try {\n    setRefreshStatus('refreshing');\n    const [observationsResp, summariesResp] = await Promise.all([\n      fetch(\n        `/api/memories?project=${encodeURIComponent(currentProject || '')}`,\n      ),\n      fetch(\n        `/api/summaries?project=${encodeURIComponent(currentProject || '')}`,\n      ),\n    ]);\n\n    const observations = await observationsResp.json();\n    const summaries = await summariesResp.json();\n\n    const summaryItems = summaries.items || [];\n    const observationItems = observations.items || [];\n    const filteredObservations = observationItems.filter(\n      (item: any) => !isLowSignalObservation(item),\n    );\n    const filteredCount = observationItems.length - filteredObservations.length;\n    const feedItems = [...summaryItems, ...filteredObservations].sort(\n      (a, b) => {\n        const left = new Date(a.created_at || 0).getTime();\n        const right = new Date(b.created_at || 0).getTime();\n        return right - left;\n      },\n    );\n    // Always apply; keep scroll stable via updateFeedView().\n\n    // Track newly appearing items for a brief highlight.\n    const incomingNewCount = countNewItems(feedItems, lastFeedItems);\n    if (incomingNewCount) {\n      const seen = new Set(lastFeedItems.map(itemKey));\n      feedItems.forEach((item: any) => {\n        const key = itemKey(item);\n        if (!seen.has(key)) newItemKeys.add(key);\n      });\n    }\n\n    pendingFeedItems = null;\n    lastFeedItems = feedItems;\n    lastFeedFilteredCount = filteredCount;\n    updateFeedView();\n    setRefreshStatus('idle');\n  } catch {\n    setRefreshStatus('error');\n  }\n}\n\nasync function loadConfig() {\n  if (isSettingsOpen()) {\n    // Avoid blowing away in-progress edits while the modal is open.\n    return;\n  }\n  try {\n    const resp = await fetch('/api/config');\n    if (!resp.ok) return;\n    const payload = await resp.json();\n    renderConfigModal(payload);\n    hideSettingsOverrideNotice(payload.config || {});\n  } catch {\n    // Ignore config load errors.\n  }\n}\n\nasync function loadSyncStatus() {\n  try {\n    const diag = isSyncDiagnosticsOpen();\n    const diagParam = diag ? '?includeDiagnostics=1' : '';\n    const resp = await fetch(`/api/sync/status${diagParam}`);\n    if (!resp.ok) return;\n    const payload = await resp.json();\n    lastSyncStatus = payload.status || null;\n    lastSyncPeers = payload.peers || [];\n    lastSyncAttempts = payload.attempts || [];\n    renderSyncStatus(lastSyncStatus);\n    renderSyncPeers(lastSyncPeers);\n    renderSyncAttempts(lastSyncAttempts);\n    if (syncMeta) {\n      const last =\n        lastSyncStatus?.last_sync_at || lastSyncStatus?.last_sync_at_utc || '';\n      syncMeta.textContent = last\n        ? `Last sync: ${formatTimestamp(last)}`\n        : 'Sync ready';\n    }\n    renderSyncHealth({\n      status: lastSyncStatus?.daemon_state || 'unknown',\n      details: lastSyncStatus?.daemon_state === 'error' ? 'daemon error' : '',\n    });\n  } catch {\n    if (syncMeta) syncMeta.textContent = 'Sync unavailable';\n  }\n}\n\nasync function loadPairing() {\n  try {\n    const resp = await fetch('/api/sync/pairing?includeDiagnostics=1');\n    if (!resp.ok) return;\n    const payload = await resp.json();\n    pairingPayloadRaw = payload || null;\n    renderPairing(payload || null);\n  } catch {\n    renderPairing(null);\n  }\n}\n\nasync function loadProjects() {\n  try {\n    const resp = await fetch('/api/projects');\n    if (!resp.ok) return;\n    const payload = await resp.json();\n    const projects = payload.projects || [];\n    if (!projectFilter) return;\n    projectFilter.textContent = '';\n    const allOption = createElement(\n      'option',\n      null,\n      'All Projects',\n    ) as HTMLOptionElement;\n    allOption.value = '';\n    projectFilter.appendChild(allOption);\n    projects.forEach((project: string) => {\n      const option = createElement(\n        'option',\n        null,\n        project,\n      ) as HTMLOptionElement;\n      option.value = project;\n      projectFilter.appendChild(option);\n    });\n  } catch {\n    // Ignore project load errors.\n  }\n}\n\nprojectFilter?.addEventListener('change', () => {\n  currentProject = projectFilter.value || '';\n  refresh();\n});\n\nasync function refresh() {\n  if (refreshInFlight) {\n    refreshQueued = true;\n    return;\n  }\n  refreshInFlight = true;\n  try {\n    await Promise.all([\n      loadStats(),\n      loadFeed(),\n      loadConfig(),\n      loadSyncStatus(),\n    ]);\n\n    if (isSyncPairingOpen()) {\n      loadPairing();\n    } else {\n      pairingPayloadRaw = null;\n      pairingCommandRaw = '';\n      if (syncPairing) (syncPairing as any).hidden = true;\n    }\n  } finally {\n    refreshInFlight = false;\n    if (refreshQueued) {\n      refreshQueued = false;\n      refresh();\n    }\n  }\n}\n\nloadProjects();\nrefresh();\nstartPolling();\n"],"names":["metaLine","expandKey","expanded","canClamp"],"mappings":"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"}